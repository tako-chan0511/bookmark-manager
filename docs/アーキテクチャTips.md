1. App.vue
役割

ナビゲーションバーと <router-view> のラッパー。

通常ユーザー vs サンドボックス（ダミー）ユーザーを user.value.email === DUMMY_EMAIL で判定し、「ようこそ」「🧪 サンドボックス」表示を切り替え。

ダーク／ライトモード切り替えボタンを設置し、CSS カスタムプロパティ切り替えをトグル。

2. views/ ディレクトリ
2.1 Login.vue
役割

メール／パスワードログイン、新規登録フォーム。

「サンドボックスモードで試す」ボタンは、事前登録済みのダミーアカウント情報（例：hara.keisuke2@i.softbank.jp / tako1234）を使って signIn し、Dashboard へ遷移。

3. components/BookmarkForm.vue
役割

ブックマーク追加フォーム。

Supabase への INSERT → タグ UPSERT → Pivot INSERT のみ。

サンドボックス対応

ローカルストレージ切り替え処理を削除し、サンドボックスでも Supabase に同じアカウントで書き込む方式へ統一。

4. components/BookmarkList.vue
役割

Supabase からフェッチしたブックマークをカードレイアウトで表示。

編集・削除は Supabase へ直接適用。

サンドボックス対応

ローカルストレージ分岐を削除し、ダミーアカウントによるアクセスと同一の CRUD 処理を行うことで切り替え。

5. 認証・データ層
supabase/supabase.ts & useAuth.ts
サンドボックス対応

useAuth 内ではセッション取得のみ。サンドボックスは「ログイン画面でダミーID/PWを渡す」ことで実現し、コード中の分岐不要に。

6. ルーティング (router/index.ts)
役割

meta.requiresAuth 付きルートをガード。

signIn 後のセッション有無だけでなく、サンドボックス用ダミーアカウントでも同様に通過。

全体を通じての学び・Tips
単一責任

認証は useAuth、データ取得は各コンポーネントで分離。

サンドボックスは“別ユーザー”として扱う

ローカルストレージ分岐をやめ、あらかじめ Supabase に作成したダミーアカウントをログインするだけ。

テーマ切り替えは CSS カスタムプロパティ一元管理

アプリ全体の見た目を data-theme 属性で制御。

Supabase × TypeScript

import.meta.env 設定や ESM/CJS 混在対策は Vite 側で完結させる。

UI/UX

検索／追加／一覧を明確にセクション化。カードやボタンの統一感は CSS カスタムプロパティで保つ。

以上の形で「ローカルストレージ不要、ダミーアカウントによるサンドボックス切り替え」を反映した構成が完成形です。ご確認ください！

💡 苦労したポイント／Tips
サンドボックスモードの実装

当初のローカルストレージ分岐をやめ、あらかじめ Supabase に用意した「ダミーアカウント」を使う方式に統一。

ロジック二重化がなくなり、CRUD メソッドも本番アカウントとまったく同じにできた。

Vue Router のガード設定

beforeEach で「通常セッション or ダミーID」どちらでも通過させる条件を整理。

localStorage 不要化により分岐がスッキリ。

Supabase 環境変数＆TypeScript 設定

import.meta.env.VITE_… の型エラー回避や、ESM/CJS のシンタックス不整合でハマりやすい。

tsconfig.json の module を esnext 系に合わせ、allowJs／types 周りを調整。

CSS カスタムプロパティでテーマ管理

ダーク／ライトは data-theme 属性切り替え＋:root 定義だけで一元管理。

局所スタイルの上書きが減り、後々のメンテがラクに。

カード＆ボタンの統一感

最終段階で「青い追加ボタンに合わせて全ボタンを統一」「文字ウェイトを揃える」など、スタイルの“共通化”を徹底。

共通クラス（例：.btn-primary）を作り、各コンポーネントで使い回すとベター。

コンポーネント分割の落とし穴

最初は BookmarkForm／BookmarkList がそれぞれ別々にタグ操作を持っていて複雑化。

「タグ CRUD はどこまでコンポーネントの責任か？」を整理し、ロジックはフック（useTags）に切り出すとグッド。

開発ツールまわり

VSCode のエイリアス解決（@/…）で一度ビルドが通らなくなるケースあり。vite.config.ts の resolve.alias を要チェック。

ブラウザキャッシュ／DevTools のハードリロードで新しいテーマ・スタイルが反映されない問題にも注意。

これらを踏まえると、  

ロジックは極力フック／サービス層にまとめ

UI は CSS 変数＋共通ユーティリティクラスで統一
  といった設計が、拡張・保守を楽にしてくれます。 ぜひご活用ください！